<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:tabView="clr-namespace:Syncfusion.Maui.TabView;assembly=Syncfusion.Maui.TabView"
             xmlns:bottomSheet="clr-namespace:Syncfusion.Maui.Toolkit.BottomSheet;assembly=Syncfusion.Maui.Toolkit"
            xmlns:syncfusionCards="clr-namespace:Syncfusion.Maui.Cards;assembly=Syncfusion.Maui.Cards"
            xmlns:buttons="clr-namespace:Syncfusion.Maui.Buttons;assembly=Syncfusion.Maui.Buttons"
            xmlns:carousel="clr-namespace:Syncfusion.Maui.Carousel;assembly=Syncfusion.Maui.Carousel"
            xmlns:local="clr-namespace:DigitalMobileBank.ViewModel"
             x:Class="DigitalMobileBank.MainPage">

    <ContentPage.BindingContext>
        <local:CardsViewModel/>
    </ContentPage.BindingContext>

    <Grid>
        <tabView:SfTabView x:Name="tabView"
                TabBarPlacement="Bottom">
            <tabView:SfTabView.Items>
                <tabView:SfTabItem Header="Home">
                    <tabView:SfTabItem.Content>
                        <VerticalStackLayout Padding="10" Spacing="20">
                            <!-- Header -->
                            <Grid RowDefinitions="Auto" ColumnDefinitions="*,Auto,*">
                                <Image Source="user_icon.png" WidthRequest="40" HeightRequest="40" Grid.Column="0" />
                                <Label Text="Home" Grid.Column="1" HorizontalOptions="Center" VerticalOptions="Center"  />
                                <Image Source="menu_icon.png" Grid.Column="2" WidthRequest="40" HeightRequest="40"  />
                            </Grid>

                            <!-- Balance Section -->
                            <VerticalStackLayout HorizontalOptions="Center" Spacing="5">
                                <Label Text="€ 6,815.53" FontSize="30" FontAttributes="Bold" HorizontalTextAlignment="Center" />
                                <Label Text="Current balance" FontSize="16" TextColor="Gray" HorizontalTextAlignment="Center" />

                            </VerticalStackLayout>

                            <carousel:SfCarousel ItemsSource="{Binding CardsList}" 
                                             Grid.Row="2" 
                                             EnableInteraction="True" 
                                             ViewMode="Default" 
                                             RotationAngle="0" 
                                             SelectedItemOffset="125" 
                                             EnableVirtualization="False"
                                             SelectionChanged="SfCarousel_SelectionChanged"
                                             SwipeMovementMode="SingleItem" 
                                             ItemHeight="200" 
                                             ItemWidth="310">
                                <carousel:SfCarousel.ItemTemplate>
                                    <DataTemplate>
                                        <Border StrokeShape="RoundRectangle, 18">
                                            <Grid>
                                                <Grid.Background>
                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                        <GradientStop Color="#4D475B" Offset="0.0" />
                                                        <GradientStop Color="#3C3647" Offset="0.5" />
                                                        <GradientStop Color="#312D3A" Offset="1.0" />
                                                    </LinearGradientBrush>
                                                </Grid.Background>

                                                <Grid ColumnDefinitions="*,Auto">
                                                    <Label Text="P U L S E" 
                                                         CharacterSpacing="2"
                                                         AnchorX="0.4"
                                                         FontSize="30"
                                                         AnchorY="0.8"
                                                         Rotation="-90"
                                                         VerticalOptions="Center"
                                                         HorizontalOptions="Start"
                                                         />
                                                    <Grid Grid.Column="1"
                                                       RowDefinitions="*,60,70"
                                                       Padding="10,10">
                                                        <Label Text="{Binding CardName}"
                                                            HorizontalOptions="End"
                                                            FontSize="Medium"/>
                                                        <Image Source="cardchip.png" 
                                                            Grid.Row="1"
                                                            HorizontalOptions="End"
                                                            VerticalOptions="Center"
                                                            WidthRequest="40" 
                                                            HeightRequest="40"/>
                                                        <Label Text="VISA" 
                                                            Grid.Row="2"
                                                            HorizontalOptions="End"
                                                            VerticalOptions="Center"
                                                            FontAttributes="Italic" 
                                                            FontSize="Medium"/>
                                                    </Grid>
                                                </Grid>
                                            </Grid>

                                        </Border>

                                    </DataTemplate>
                                </carousel:SfCarousel.ItemTemplate>
                            </carousel:SfCarousel>

                            <!-- Action Buttons -->
                            <Grid ColumnDefinitions="*,*,*,*" HorizontalOptions="FillAndExpand">
                                <VerticalStackLayout HorizontalOptions="Center" Grid.Column="0">
                                    <buttons:SfButton Text="Top up" HeightRequest="50" WidthRequest="50" CornerRadius="25" />
                                    <Label Text="Top up" HorizontalTextAlignment="Center" />
                                </VerticalStackLayout>
                                <VerticalStackLayout HorizontalOptions="Center" Grid.Column="1">
                                    <buttons:SfButton Text="Exchange" HeightRequest="50" WidthRequest="50" CornerRadius="25" />
                                    <Label Text="Exchange" HorizontalTextAlignment="Center" />
                                </VerticalStackLayout>
                                <VerticalStackLayout HorizontalOptions="Center" Grid.Column="2">
                                    <buttons:SfButton Text="Transfer" HeightRequest="50" WidthRequest="50" CornerRadius="25" Clicked="SfButton_Clicked" />
                                    <Label Text="Transfer" HorizontalTextAlignment="Center" />
                                </VerticalStackLayout>
                                <VerticalStackLayout HorizontalOptions="Center" Grid.Column="3">
                                    <buttons:SfButton Text="Details" HeightRequest="50" WidthRequest="50" CornerRadius="25" />
                                    <Label Text="Details" HorizontalTextAlignment="Center" />
                                </VerticalStackLayout>
                            </Grid>

                            <!-- Transactions Section -->
                            <VerticalStackLayout>
                                <Grid RowDefinitions="Auto,Auto" ColumnDefinitions="*,Auto">
                                    <Label Text="Transactions" FontSize="18" FontAttributes="Bold" />
                                    <Button Text="View all" Grid.Column="1" BackgroundColor="Transparent" TextColor="Blue" />
                                </Grid>
                                <CollectionView ItemsSource="{Binding Transactions}" HeightRequest="100">
                                    <CollectionView.ItemTemplate>
                                        <DataTemplate>
                                            <Grid ColumnDefinitions="Auto,*,Auto" RowDefinitions="Auto">
                                                <Image Source="{Binding UserImage}" WidthRequest="40" HeightRequest="40" />
                                                <VerticalStackLayout Grid.Column="1">
                                                    <Label Text="{Binding Title}" FontSize="16" />
                                                    <Label Text="{Binding Date}" FontSize="12" TextColor="Gray" />
                                                </VerticalStackLayout>
                                                <Label Text="{Binding Amount}" Grid.Column="2" FontSize="16" HorizontalTextAlignment="End" />
                                            </Grid>
                                        </DataTemplate>
                                    </CollectionView.ItemTemplate>
                                </CollectionView>
                            </VerticalStackLayout>

                            <!-- Footer Navigation -->
                            <Grid ColumnDefinitions="*,*,*,*,*" HorizontalOptions="FillAndExpand">
                                <VerticalStackLayout HorizontalOptions="Center" Grid.Column="0">
                                    <Image Source="home_icon.png" WidthRequest="50" HeightRequest="30" />
                                    <Label Text="Home" HorizontalTextAlignment="Center" />
                                </VerticalStackLayout>
                                <VerticalStackLayout HorizontalOptions="Center" Grid.Column="1">
                                    <Image Source="transactions_icon.png" WidthRequest="50" HeightRequest="30" />
                                    <Label Text="Transactions" HorizontalTextAlignment="Center" />
                                </VerticalStackLayout>
                                <VerticalStackLayout HorizontalOptions="Center" Grid.Column="2">
                                    <Image Source="reports_icon.png" WidthRequest="50" HeightRequest="30" />
                                    <Label Text="Reports" HorizontalTextAlignment="Center" />
                                </VerticalStackLayout>
                                <VerticalStackLayout HorizontalOptions="Center" Grid.Column="3">
                                    <Image Source="manage_icon.png" WidthRequest="50" HeightRequest="30" />
                                    <Label Text="Manage" HorizontalTextAlignment="Center" />
                                </VerticalStackLayout>
                            </Grid>
                        </VerticalStackLayout>
                    </tabView:SfTabItem.Content>
                </tabView:SfTabItem>

                <tabView:SfTabItem Header="Call">
                    <tabView:SfTabItem.Content>
                        <Grid RowDefinitions="Auto" ColumnDefinitions="*,Auto,Auto">
                            <Label Text="Home" FontSize="24" FontAttributes="Bold" VerticalOptions="Center" />
                            <Image Source="dotnet_bot.png" WidthRequest="40" HeightRequest="40" Aspect="AspectFill"  Grid.Column="1" />
                            <Image Source="dotnet_bot.png" WidthRequest="30" HeightRequest="30" Grid.Column="2" />
                        </Grid>
                    </tabView:SfTabItem.Content>
                </tabView:SfTabItem>

                <tabView:SfTabItem Header="Call">
                    <tabView:SfTabItem.Content>
                        <Grid RowDefinitions="Auto" ColumnDefinitions="*,Auto,Auto">
                            <Label Text="Home" FontSize="24" FontAttributes="Bold" VerticalOptions="Center" />
                            <Image Source="dotnet_bot.png" WidthRequest="40" HeightRequest="40" Aspect="AspectFill"  Grid.Column="1" />
                            <Image Source="dotnet_bot.png" WidthRequest="30" HeightRequest="30" Grid.Column="2" />
                        </Grid>
                    </tabView:SfTabItem.Content>
                </tabView:SfTabItem>

                <tabView:SfTabItem  Header="Call">
                    <tabView:SfTabItem.Content>
                        <Grid RowDefinitions="Auto" ColumnDefinitions="*,Auto,Auto">
                            <Label Text="Home" FontSize="24" FontAttributes="Bold" VerticalOptions="Center" />
                            <Image Source="dotnet_bot.png" WidthRequest="40" HeightRequest="40" Aspect="AspectFill"  Grid.Column="1" />
                            <Image Source="dotnet_bot.png" WidthRequest="30" HeightRequest="30" Grid.Column="2" />
                        </Grid>
                    </tabView:SfTabItem.Content>
                </tabView:SfTabItem>
            </tabView:SfTabView.Items>
        </tabView:SfTabView>

        <bottomSheet:SfBottomSheet x:Name="bottomSheet" CornerRadius="15, 15, 0, 0" HalfExpandedRatio="0.35" ContentPadding="10">
            <bottomSheet:SfBottomSheet.BottomSheetContent>
                <VerticalStackLayout Padding="10">
                    <!-- Search Bar -->
                    <SearchBar Placeholder="Search contacts"
               TextChanged="SearchBar_TextChanged"
               x:Name="SearchBar" />

                    <!-- CollectionView -->
                    <CollectionView x:Name="ContactsCollectionView"
    ItemsSource="{Binding FilteredContacts}">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Grid Padding="10" ColumnDefinitions="Auto, *, Auto">
                                    <!-- Avatar -->
                                    <Frame BackgroundColor="LightGray"
           CornerRadius="25"
           WidthRequest="50"
           HeightRequest="50"
           VerticalOptions="Center">
                                        <Label Text="{Binding Initials}"
               HorizontalOptions="Center"
               VerticalOptions="Center"
               TextColor="White" />
                                    </Frame>
                                    <!-- Contact Details -->
                                    <VerticalStackLayout Grid.Column="1" Spacing="5">
                                        <Label Text="{Binding Name}" FontSize="16" FontAttributes="Bold" />
                                        <Label Text="{Binding Details}" FontSize="14" TextColor="Gray" />
                                    </VerticalStackLayout>
                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>
            </bottomSheet:SfBottomSheet.BottomSheetContent>
        </bottomSheet:SfBottomSheet>
    </Grid>

</ContentPage>
